{% extends 'base.html' %}

{% block content %}
    <h1>{% block title %} Cvi캜n칳 test z praktick칠 캜치sti zkou코ky z Farmaceutick칠 botaniky {% endblock %}</h1>

    <div style="padding-left: 60px; padding-right: 60px;">
        <p><strong>! UPOZORN캨N칈 !</strong><span style="float: right;">游섫릖<a href="{{ url_for('recognition_botany') }}">English</a></span></p>
        <p style="text-align: justify; text-justify: inter-word;">Jedn치 se o neofici치ln칤 materi치l, kter칳 slou쮂 pouze jako u캜ebn칤 pom콢cka a v 쮂멳n칠m p콏칤pad캩 nenahrazuje
        doporu캜en칠 studijn칤 zdroje. 콯치dn칳 z 캜len콢 katedry KFGFB neru캜칤 za spr치vnost a aktu치lnost tohoto materi치lu. Pro
            nejaktu치ln캩j코칤 vyhl치코ky a seznamy pros칤m sledujte sekci <a href="https://intranet.faf.cuni.cz/Studijni-materialy/KFGFB/"
            target="_blank"> studijn칤ch materi치l콢 katedry na webu FAF</a>. Tento cvi캜n칳 test vych치z칤 z <a href="static/seznam_taxonu.pdf"
            target="_blank">tohoto seznamu</a>, je by m캩l b칳t aktu치ln칤 i pro rok 2023. V캩t코ina obrazov칳ch materi치l콢
            je p콏evzat치 z webu <a href="https://apps.faf.cuni.cz/daidalea/Default.asp">Daidalea</a>, kter칳 je pro
            samostudium v칳razn캩 doporu캜en.
        </p>
        <p id='cisloOtazky' style="font-weight: bold;">Ot치zka 캜. 1</p>
        <div class="img-container">
        <img src="" id="obr1">
        <img src="" id="obr2">
        <img src="" id="obr3">
        </div>

        <br>
        <input type="button" style="cursor: pointer;" value="Zv캩t코it" onclick="zvetsitIMG()">
        <input type="button" style="cursor: pointer;" value="Zmen코it" onclick="zmensitIMG()">
        <br>
        <p id="vypisBodu" style="font-weight: bold">Body: 0/45</p>
        Latinsk칳 n치zev: <input type="text" id="odpoved_1" name="odpoved_1" style="font-style: italic;"> <span id="result1"></span> <br><br>
        캛esk칳 n치zev:  <input type="text" id="odpoved_2" name="odpoved_2"> <span id="result2"></span> <br><br>
        캛ele캞 latinsky: <input type="text" id="odpoved_3" name="odpoved_3"> <span id="result3"></span> <br><br>
        캛ele캞 캜esky: <input type="text" id="odpoved_4" name="odpoved_4"> <span id="result4"></span> <br>
        <p id="trestnyText"></p>
        <input type="button" style="cursor: pointer;" onclick="zkontrolujOdpoved()" value="Zkontrolovat" id="kontrolBtn">
        <input type="button" style="cursor: pointer; display: none;" onclick="window.location.reload()" value="Nov칳 test" id="novyTestBtn">

    </div>
<script type="text/javascript">
    var imgVelikost = 350;
    var poradi = 0;
    var body = 0;
    var vybraneRostliny = {{ vyber | tojson | safe }};
    var cestyObr = {{ paths | tojson | safe }};

    function zvetsitIMG() {
        imgVelikost = String(imgVelikost*1.2);
        document.getElementById('obr1').style.height = imgVelikost + 'px';
        document.getElementById('obr2').style.height = imgVelikost + 'px';
        document.getElementById('obr3').style.height = imgVelikost + 'px';
    }
    function zmensitIMG() {
        imgVelikost = String(imgVelikost/1.2);
        document.getElementById('obr1').style.height = imgVelikost + 'px';
        document.getElementById('obr2').style.height = imgVelikost + 'px';
        document.getElementById('obr3').style.height = imgVelikost + 'px';
    }
    function zkontrolujOdpoved() {
        if (document.getElementById('kontrolBtn').value == "Dal코칤") {
            poradi++;
            document.getElementById('cisloOtazky').innerHTML = "Ot치zka 캜. " + (poradi+1);
            document.getElementById('obr1').src = cestyObr[poradi][0];
            document.getElementById('obr2').src = cestyObr[poradi][1];
            document.getElementById('obr3').src = cestyObr[poradi][2];
            document.getElementById('result1').innerHTML = "";
            document.getElementById('result2').innerHTML = "";
            document.getElementById('result3').innerHTML = "";
            document.getElementById('result4').innerHTML = "";
            document.getElementById('odpoved_1').value = "";
            document.getElementById('odpoved_2').value = "";
            document.getElementById('odpoved_3').value = "";
            document.getElementById('odpoved_4').value = "";
            document.getElementById('trestnyText').innerHTML = "";
            document.getElementById('kontrolBtn').value = "Zkontrolovat";
        } else {
            let odpoved_1 = document.getElementById('odpoved_1').value.trim().toLowerCase();
            var druhRodLatOdpv = odpoved_1.split(" ");
            var rodLatOdpv = druhRodLatOdpv[0];
            var druhLatOdpv = druhRodLatOdpv[1];
            if (odpoved_1.includes("sylvestris var. mauritiana") == true) {
                druhLatOdpv = "sylvestris var. mauritiana";
            }
            if (odpoved_1.includes("sect. rubus") == true) {
                druhLatOdpv = "sect. rubus";
            }
            if (odpoved_1.includes("piperita") == true) {
                druhLatOdpv = "piperita";
            }
            let latinsky_druh_spravne = vybraneRostliny[poradi][1].trim();
            var druhRodLat = latinsky_druh_spravne.split(" ");
            var rodLat = druhRodLat[0].toLowerCase();
            var druhLat = druhRodLat[1];
            if (latinsky_druh_spravne == "Malva sylvestris var. mauritiana") {
                druhLat = "sylvestris var. mauritiana";
            }
            if (latinsky_druh_spravne == "Rubus sect. Rubus") {
                druhLat = "sect. Rubus";
            }
            if (latinsky_druh_spravne == "Mentha 칑 piperita") {
                druhLat = "piperita";
            }
            if (rodLatOdpv == rodLat && druhLatOdpv == druhLat) {
                document.getElementById('result1').innerHTML = "Spr치vn캩!";
                body = body + 1;
            } else if (rodLatOdpv == rodLat && druhLatOdpv != druhLat) {
                document.getElementById('result1').innerHTML = "맗atn칳 druhov칳 n치zev, spr치vn캩 to m치 b칳t: <em>" + latinsky_druh_spravne;
                body = body + 0.5;
            } else if (rodLatOdpv != rodLat && druhLatOdpv == druhLat) {
                document.getElementById('result1').innerHTML = "맗atn칳 rodov칳 n치zev, spr치vn캩 to m치 b칳t: <em>" + latinsky_druh_spravne;
                body = body + 0.5;
            } else {
                document.getElementById('result1').innerHTML = "맗atn캩, spr치vn캩 to m치 b칳t: <em>" + latinsky_druh_spravne;
            }

            let odpoved_2 = bezDiakr(document.getElementById('odpoved_2').value.trim().toLowerCase());
            var odpoved_2_split = odpoved_2.split(" ");
            var odpvRod = odpoved_2_split[0];
            var odpvDruh = odpoved_2_split[1];
            if (odpoved_2.includes("recke seno") == true) {
                odpvDruh = "recke seno";
            }
            if (odpoved_2.includes("lesni maursky") == true) {
                odpvDruh = "lesni maursky";
            }
            if (odpoved_2.includes("pastusi tobolka") == true) {
                odpvDruh = "pastusi tobolka";
            }
            let cesky_druh_spravne = vybraneRostliny[poradi][2].trim().toLowerCase();
            let spravne_split = cesky_druh_spravne.split(" ");
            var spravneRod = bezDiakr(spravne_split[0]);
            var spravneDruh = bezDiakr(spravne_split[1]);
            if (cesky_druh_spravne == "p칤skavice 콏eck칠 seno") {
                spravneDruh = "recke seno";
            }
            if (cesky_druh_spravne == "sl칠z lesn칤 maursk칳") {
                spravneDruh = "lesni maursky";
            }
            if (cesky_druh_spravne == "koko코ka pastu코칤 tobolka") {
                spravneDruh = "pastusi tobolka";
            }
            if (odpvRod == spravneRod && odpvDruh == spravneDruh) {
                document.getElementById('result2').innerHTML = "Spr치vn캩!";
                body++;
            } else if (odpvRod == spravneRod && odpvDruh != spravneDruh) {
                document.getElementById('result2').innerHTML = "맗atn칳 druhov칳 n치zev, spr치vn캩 to m치 b칳t: " + cesky_druh_spravne;
                body = body + 0.5;
            } else if (odpvRod != spravneRod && odpvDruh == spravneDruh) {
                document.getElementById('result2').innerHTML = "맗atn칳 rodov칳 n치zev, spr치vn캩 to m치 b칳t: " + cesky_druh_spravne;
                body = body + 0.5;
            } else {
                document.getElementById('result2').innerHTML = "맗atn캩, spr치vn캩 to m치 b칳t: " + cesky_druh_spravne;
            }
            let odpoved_3 = document.getElementById('odpoved_3').value;
            let latinsky_celed_spravne = vybraneRostliny[poradi][3].trim();
            if (odpoved_3.trim().toLowerCase() == latinsky_celed_spravne.toLowerCase()) {
                document.getElementById('result3').innerHTML = "Spr치vn캩!";
                body = body + 0.5;
            } else {
                document.getElementById('result3').innerHTML = "맗atn캩, spr치vn캩 to m치 b칳t: " + latinsky_celed_spravne;
            }
            let odpoved_4 = document.getElementById('odpoved_4').value;
            let cesky_celed_spravne = vybraneRostliny[poradi][4].trim();
            if (bezDiakr(odpoved_4.trim().toLowerCase()) == bezDiakr(cesky_celed_spravne.toLowerCase())) {
                document.getElementById('result4').innerHTML = "Spr치vn캩!";
                body = body + 0.5;
            } else {
                document.getElementById('result4').innerHTML = "맗atn캩, spr치vn캩 to m치 b칳t: " + cesky_celed_spravne;
            }
            var lekopisna = vybraneRostliny[poradi][5];
            if (lekopisna != null) {
                if (document.getElementById('result4').innerHTML != "Spr치vn캩!" ||
                    document.getElementById('result3').innerHTML != "Spr치vn캩!" ||
                    document.getElementById('result2').innerHTML != "Spr치vn캩!" ||
                    document.getElementById('result1').innerHTML != "Spr치vn캩!") {
                    document.getElementById('trestnyText').innerHTML = "Rostlina je l칠kopisn치, jej칤 neznalost je za 1 trestn칳 bod!";
                    body = body - 1;
                }
            }
            document.getElementById('vypisBodu').innerHTML = "Tvoje body: " + body + "/45";
            if (poradi == 14) {
                document.getElementById('kontrolBtn').value = "Konec testu";
                document.getElementById('kontrolBtn').disabled = true;
                document.getElementById('novyTestBtn').style.display = "inline";
                if (body >= 27) {
                    document.getElementById('vypisBodu').innerHTML = "Tvoje body: " + body + "/45 - Minim치ln칤 hranice 칰sp캩코nosti 60% spln캩na, gratuluji!";
                } else {
                    document.getElementById('vypisBodu').innerHTML = "Tvoje body: " + body + "/45 - Nedostate캜n칠 body pro spln캩n칤 minim치ln칤 hranice 칰sp캩코nosti 60 %, je pot콏eba se to je코t캩 nau캜it!";
                }

            } else {
                document.getElementById('kontrolBtn').value = "Dal코칤";
            }
        }
    }
    function bezDiakr(retezec) {
        return retezec.normalize("NFD").replace(/\p{Diacritic}/gu, "");
    }
    window.addEventListener('beforeunload', function (e) {
        // zpr치va, kter치 se zobraz칤 v dialogov칠m okn캩 prohl칤쬰캜e
        var message = 'Pokud opust칤te tuto str치nku, ztrat칤te sv콢j progres.';
        e.preventDefault(); // zru코칤 ud치lost
        e.returnValue = message; // Chrome, IE
        return message; // Gecko, WebKit, Safari
    });

    document.getElementById('obr1').src = cestyObr[poradi][0];
    document.getElementById('obr2').src = cestyObr[poradi][1];
    document.getElementById('obr3').src = cestyObr[poradi][2];
</script>

{% endblock %}